import{I as ye}from"./index.ec6cb9aa.js";import{M as be}from"./index.6b4a0ed9.js";import{C as he}from"./index.08f9ebae.js";import{F as ge,u as Ce}from"./provide.b10968b0.js";import{d as Ve,a as m,b as $,w as U,_ as Fe,n as _,s as E,f as u,h as y,l as c,H as r,J as W,t as Y,P,K as k,F as ke,ad as we,i as x,M as Me,N as D,ac as Be,k as ee}from"./elevation.e55d3ca3.js";import{y as Se,e as i,c as Te,B as O,l as Ee}from"./components.69d5bae5.js";import{u as De}from"./index.93cc5410.js";import{t as z}from"./elements.afe20251.js";function Oe(e){return["left","right","center"].includes(e)}const Ne={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Oe},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const{n:L,classes:Ae}=Te("select"),He=Ve({name:"VarSelect",components:{VarIcon:ye,VarMenu:be,VarChip:he,VarFormDetails:ge},props:Ne,setup(e){const t=m(null),f=m(!1),j=$(()=>e.multiple),J=$(()=>e.focusColor),w=m(""),M=m([]),b=m("0px"),v=m(0),{bindForm:N,form:l}=Ce(),{length:le,options:h,bindOptions:ae}=De(),{errorMessage:se,validateWithTrigger:oe,validate:ne,resetValidation:A}=Se(),H=m(null),re=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;M.value=o.map(K)}!a&&!O(s)&&(w.value=K(s)),!a&&O(s)&&(w.value="")},g=a=>{_(()=>{const{validateTrigger:s,rules:o,modelValue:n}=e;oe(s,a,o,n)})},B=({value:a,label:s})=>a.value!=null?a.value:s.value,K=a=>{var o;let s=h.find(({value:n})=>n.value===a);return s||(s=h.find(({label:n})=>n.value===a)),(o=s==null?void 0:s.label.value)!=null?o:""},te=()=>{const{hint:a,modelValue:s}=e;if(!a&&!O(s))return L("--placeholder-hidden");if(a&&(!O(s)||f.value))return L("--placeholder-hint")},q=()=>t.value&&window.getComputedStyle(t.value).width||"0px",S=()=>{const a=t.value&&window.getComputedStyle(t.value).paddingTop||"0px";return z(a)*1.5},ie=()=>{const{disabled:a,readonly:s,onFocus:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(b.value=q(),v.value=S()+z(e.offsetY),f.value=!0,i(o),g("onFocus"),X())},de=()=>{const{disabled:a,readonly:s,onBlur:o}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||(i(o),g("onBlur"))},ue=a=>{const{disabled:s,readonly:o,multiple:n,onChange:p}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const d=n?h.filter(({selected:C})=>C.value).map(B):B(a);i(e["onUpdate:modelValue"],d),i(p,d),g("onChange"),!n&&(f.value=!1)},ce=()=>{const{disabled:a,readonly:s,multiple:o,clearable:n,onClear:p}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||s||!n)return;const d=o?[]:void 0;i(e["onUpdate:modelValue"],d),i(p,d),g("onClear")},fe=a=>{const{disabled:s,onClick:o}=e;(l==null?void 0:l.disabled.value)||s||(i(o,a),g("onClick"))},ve=a=>{const{disabled:s,readonly:o,modelValue:n,onClose:p}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||o)return;const d=n,C=h.find(({label:V})=>V.value===a),T=d.filter(V=>{var F;return V!==((F=C.value.value)!=null?F:C.label.value)});i(e["onUpdate:modelValue"],T),i(p,T),g("onClose")},G=()=>{const{multiple:a,modelValue:s}=e;if(a){const o=s;h.forEach(n=>n.sync(o.includes(B(n))))}else h.forEach(o=>o.sync(s===B(o)));re()},pe=()=>{b.value=q(),v.value=S()+z(e.offsetY),f.value=!0,X()},me=()=>{f.value=!1},Q=()=>ne(e.rules,e.modelValue),R=()=>{i(e["onUpdate:modelValue"],e.multiple?[]:void 0),A()},X=()=>{const{body:a}=document;_(()=>{var V,F;const{offsetTop:s,offsetHeight:o}=(V=H.value)==null?void 0:V.parentElement,n=a.scrollHeight-o-s,p=a.offsetTop,d=a.scrollHeight-a.offsetHeight-a.offsetTop,C=s-p,T=n-d;C<0&&(v.value=S()),T<0&&(v.value-=((F=H.value)==null?void 0:F.parentElement).offsetHeight-S())})};U(()=>e.multiple,()=>{const{multiple:a,modelValue:s}=e;if(a&&!Ee(s))throw Error("The modelValue must be an array when multiple is true")}),U(()=>e.modelValue,G,{deep:!0}),U(()=>le.value,G);const Z={wrapWidth:$(()=>b.value),multiple:j,focusColor:J,onSelect:ue,reset:R,validate:Q,resetValidation:A};return ae(Z),i(N,Z),{wrapEl:t,offsetY:v,isFocus:f,errorMessage:se,formDisabled:l==null?void 0:l.disabled,label:w,labels:M,menuEl:H,n:L,classes:Ae,computePlaceholderState:te,handleFocus:ie,handleBlur:de,handleClear:ce,handleClick:fe,handleClose:ve,reset:R,validate:Q,resetValidation:A,focus:pe,blur:me}}}),$e={key:0},Ue={key:1};function We(e,t,f,j,J,w){const M=E("var-chip"),b=E("var-icon"),v=E("var-menu"),N=E("var-form-details");return u(),y("div",{class:r(e.classes(e.n(),"var--box",[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:t[3]||(t[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[c("div",{class:r(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:k({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[c("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[W(e.$slots,"prepend-icon")],2),Y(v,{class:r(e.n("menu")),"var-select-cover":"","offset-y":e.offsetY,show:e.isFocus,"onUpdate:show":t[2]||(t[2]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:P(()=>[c("div",{ref:"menuEl",class:r(e.n("scroller"))},[W(e.$slots,"default")],2)]),default:P(()=>[c("div",{class:r(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:t[1]||(t[1]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[c("div",{class:r(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:k({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(u(),y("div",$e,[e.chip?(u(),y("div",{key:0,class:r(e.n("chips"))},[(u(!0),y(ke,null,we(e.labels,l=>(u(),x(M,{class:r(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:t[0]||(t[0]=Be(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:P(()=>[Me(D(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(u(),y("div",{key:1,class:r(e.n("values"))},D(e.labels.join(e.separator)),3))])):(u(),y("span",Ue,D(e.label),1)),Y(b,{class:r(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])],6),c("label",{class:r(e.classes(e.n("placeholder"),"var--ellipsis",[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:k({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},D(e.placeholder),7)],2)]),_:3},8,["class","offset-y","show","onClose"]),c("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[W(e.$slots,"append-icon",{},()=>[e.clearable?(u(),x(b,{key:0,class:r(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):ee("v-if",!0)])],2)],6),e.line?(u(),y("div",{key:0,class:r(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:k({background:e.errorMessage?void 0:e.blurColor})},[c("div",{class:r(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:k({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):ee("v-if",!0),Y(N,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var I=Fe(He,[["render",We]]);I.install=function(e){e.component(I.name,I)};export{I as S};
