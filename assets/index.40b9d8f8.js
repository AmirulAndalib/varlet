import{I as z}from"./index.e3d3045d.js";import{g as F,b as H,f as Y}from"./elements.fe3d8f92.js";import{d as C,c as j,f as I}from"./components.e153d5f1.js";import{d as q,a as l,b as m,w as Q,o as B,Z as N,_ as k,p as Z,f as h,h as E,M as G,q as J,N as T,R as K,O as W,e as X,az as x,i as D,S as R,ap as V,ai as ee,P as ae,Q as oe,F as te}from"./vue-router.esm-bundler.0e2db2be.js";import{C as se}from"./index.64085d6b.js";import{d as ne}from"./index.e436054e.js";import"./shared.1ad63abb.js";const le={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},target:{type:[String,Object]},onRefresh:C(),"onUpdate:modelValue":C()},{n:re,classes:ue}=j("pull-refresh"),P=150,ce=q({name:"VarPullRefresh",components:{VarIcon:z},props:le,setup(e){let o,d;const n=l(0),c=l(null),v=l(null),i=l(0),a=l(-999),r=l("arrow-down"),s=l("default"),u=l(!1),p=l(!0),y=m(()=>s.value!=="loading"&&s.value!=="success"&&!e.disabled),$=m(()=>({transform:`translate3d(0px, ${a.value}px, 0px) translate(-50%, 0)`,transition:u.value?`transform ${e.animationDuration}ms`:void 0,background:S.value?e.successBgColor:e.bgColor,color:S.value?e.successColor:e.color})),f=m(()=>Math.abs(2*n.value)),S=m(()=>s.value==="success"),L=()=>new Promise(t=>{window.setTimeout(()=>{p.value=!0,t()},P)}),M=t=>{!y.value||(s.value="pulling",i.value=t.touches[0].clientY)},_=t=>{const b=Y(o);if(b>0||!y.value)return;b===0&&a.value>n.value&&t.cancelable&&t.preventDefault();const w=(t.touches[0].clientY-i.value)/2+n.value;a.value=w>=f.value?f.value:w,a.value>=f.value*.2?(p.value=!1,r.value="refresh",d=L()):r.value="arrow-down"},O=async()=>{!y.value||(u.value=!0,a.value>=f.value*.2?(await d,s.value="loading",a.value=f.value*.3,I(e["onUpdate:modelValue"],!0),I(e.onRefresh)):(s.value="loosing",r.value="arrow-down",a.value=n.value,setTimeout(()=>{u.value=!1},N(e.animationDuration))))},A=()=>{const{width:t}=v.value.getBoundingClientRect();a.value=-(t+t*.25),n.value=-(t+t*.25)},U=()=>{setTimeout(()=>{s.value="default",r.value="arrow-down",u.value=!1},N(e.animationDuration))};return Q(()=>e.modelValue,t=>{t===!1&&(u.value=!0,s.value="success",r.value="checkbox-marked-circle",setTimeout(()=>{a.value=n.value,U()},N(e.successDuration)))}),B(()=>{o=e.target?F(e.target,"PullRefresh"):H(c.value),A()}),{n:re,classes:ue,iconHasChanged:p,ICON_TRANSITION:P,refreshStatus:s,freshNode:c,controlNode:v,touchStart:M,touchMove:_,touchEnd:O,iconName:r,controlStyle:$,isSuccess:S}}});function ie(e,o,d,n,c,v){const i=Z("var-icon");return h(),E("div",{ref:"freshNode",class:T(e.n()),onTouchstart:o[0]||(o[0]=(...a)=>e.touchStart&&e.touchStart(...a)),onTouchmove:o[1]||(o[1]=(...a)=>e.touchMove&&e.touchMove(...a)),onTouchend:o[2]||(o[2]=(...a)=>e.touchEnd&&e.touchEnd(...a)),onTouchcancel:o[3]||(o[3]=(...a)=>e.touchEnd&&e.touchEnd(...a))},[G("div",{ref:"controlNode",class:T(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:K(e.controlStyle)},[J(i,{name:e.iconName,transition:e.ICON_TRANSITION,class:T(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),W(e.$slots,"default")],34)}const g=k(ce,[["render",ie]]);g.install=function(e){e.component(g.name,g)};const de={setup(e){const o=Array(10).fill("List Item"),d=Array(10).fill("This is new List Item"),n=l(!1),c=l(o),v=()=>{setTimeout(()=>{c.value=c.value[0]==="List Item"?d:o,n.value=!1},2e3)},i=a=>{a.preventDefault()};return B(()=>{document.body.addEventListener("touchmove",i,{passive:!1})}),X(()=>{document.body.removeEventListener("touchmove",i)}),x(ne),(a,r)=>(h(),D(V(g),{onRefresh:v,modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=s=>n.value=s),"success-duration":"2000"},{default:R(()=>[(h(!0),E(te,null,ee(c.value,(s,u)=>(h(),D(V(se),{key:u,border:""},{default:R(()=>[ae(oe(s+" "+(u+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},Se=k(de,[["__scopeId","data-v-8f1c7769"]]);export{Se as default};
