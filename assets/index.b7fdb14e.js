import{I as ye}from"./index.e8421b61.js";import{M as be}from"./index.f80af47a.js";import{C as he}from"./index.c16c41fc.js";import{F as ge,u as Ce}from"./provide.02ec17cf.js";import{d as Ve,a as p,b as A,w as $,_ as Fe,n as _,s as S,f as u,h as y,l as v,H as r,J as U,t as W,P as Y,K as C,F as ke,ad as we,i as x,M as Me,N as B,ac as Se,k as ee}from"./elevation.e55d3ca3.js";import{x as Be,e as t,c as Ee,z as E,j as Te}from"./components.d52e50e1.js";import{u as De}from"./index.0d9e26dd.js";import{t as z}from"./elements.ec97d14b.js";function Ne(e){return["left","right","center"].includes(e)}const Oe={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Ne},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const{n:H,classes:Ae}=Ee("select"),$e=Ve({name:"VarSelect",components:{VarIcon:ye,VarMenu:be,VarChip:he,VarFormDetails:ge},props:Oe,setup(e){const i=p(null),f=p(!1),L=A(()=>e.multiple),I=A(()=>e.focusColor),V=p(""),F=p([]),b=p("0px"),m=p(0),{bindForm:T,form:l}=Ce(),{length:le,options:h,bindOptions:ae}=De(),{errorMessage:se,validateWithTrigger:ne,validate:oe,resetValidation:D}=Be(),N=p(null),re=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;F.value=n.map(j)}!s&&!E(a)&&(V.value=j(a)),!s&&E(a)&&(V.value="")},g=s=>{_(()=>{const{validateTrigger:a,rules:n,modelValue:o}=e;ne(a,s,n,o)})},k=({value:s,label:a})=>s.value!=null?s.value:a.value,j=s=>{var n;let a=h.find(({value:o})=>o.value===s);return a||(a=h.find(({label:o})=>o.value===s)),(n=a==null?void 0:a.label.value)!=null?n:""},ie=()=>{const{hint:s,modelValue:a}=e;if(!s&&!E(a))return H("--placeholder-hidden");if(s&&(!E(a)||f.value))return H("--placeholder-hint")},J=()=>i.value&&window.getComputedStyle(i.value).width||"0px",w=()=>{const s=i.value&&window.getComputedStyle(i.value).paddingTop||"0px";return z(s)*1.5},te=()=>{const{disabled:s,readonly:a,onFocus:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(b.value=J(),m.value=w()+z(e.offsetY),f.value=!0,t(n),g("onFocus"),Q())},de=()=>{const{disabled:s,readonly:a,onBlur:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(t(n),g("onBlur"))},ue=s=>{const{disabled:a,readonly:n,multiple:o,onChange:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const d=o?h.filter(({selected:M})=>M.value).map(k):k(s);t(e["onUpdate:modelValue"],d),t(c,d),g("onChange"),!o&&(f.value=!1)},ce=()=>{const{disabled:s,readonly:a,multiple:n,clearable:o,onClear:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||!o)return;const d=n?[]:void 0;t(e["onUpdate:modelValue"],d),t(c,d),g("onClear")},ve=s=>{const{disabled:a,onClick:n}=e;(l==null?void 0:l.disabled.value)||a||(t(n,s),g("onClick"))},fe=s=>{const{disabled:a,readonly:n,modelValue:o,onClose:c}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const d=o,M=h.find(({label:O})=>O.value===s),X=d.filter(O=>{var Z;return O!==((Z=M.value.value)!=null?Z:M.label.value)});t(e["onUpdate:modelValue"],X),t(c,X),g("onClose")},K=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;h.forEach(o=>o.sync(n.includes(k(o))))}else h.forEach(n=>n.sync(a===k(n)));re()},me=()=>{b.value=J(),m.value=w()+z(e.offsetY),f.value=!0,Q()},pe=()=>{f.value=!1},q=()=>oe(e.rules,e.modelValue),G=()=>{t(e["onUpdate:modelValue"],e.multiple?[]:void 0),D()},Q=()=>{const{body:s}=document;_(()=>{var c,d;const{offsetTop:a,offsetHeight:n}=(c=N.value)==null?void 0:c.parentElement,o=s.scrollHeight-n-a;a<0&&(m.value=w()),o<0&&(m.value-=((d=N.value)==null?void 0:d.parentElement).offsetHeight-w())})};$(()=>e.multiple,()=>{const{multiple:s,modelValue:a}=e;if(s&&!Te(a))throw Error("The modelValue must be an array when multiple is true")}),$(()=>e.modelValue,K,{deep:!0}),$(()=>le.value,K);const R={wrapWidth:A(()=>b.value),multiple:L,focusColor:I,onSelect:ue,reset:G,validate:q,resetValidation:D};return ae(R),t(T,R),{wrapEl:i,offsetY:m,isFocus:f,errorMessage:se,formDisabled:l==null?void 0:l.disabled,label:V,labels:F,menuEl:N,n:H,classes:Ae,computePlaceholderState:ie,handleFocus:te,handleBlur:de,handleClear:ce,handleClick:ve,handleClose:fe,reset:G,validate:q,resetValidation:D,focus:me,blur:pe}}}),Ue={key:0},We={key:1};function Ye(e,i,f,L,I,V){const F=S("var-chip"),b=S("var-icon"),m=S("var-menu"),T=S("var-form-details");return u(),y("div",{class:r(e.classes(e.n(),"var--box",[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:i[3]||(i[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[v("div",{class:r(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:C({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[v("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[U(e.$slots,"prepend-icon")],2),W(m,{class:r(e.n("menu")),"var-select-cover":"","offset-y":e.offsetY,show:e.isFocus,"onUpdate:show":i[2]||(i[2]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:Y(()=>[v("div",{ref:"menuEl",class:r(e.n("scroller"))},[U(e.$slots,"default")],2)]),default:Y(()=>[v("div",{class:r(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:i[1]||(i[1]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[v("div",{class:r(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:C({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(u(),y("div",Ue,[e.chip?(u(),y("div",{key:0,class:r(e.n("chips"))},[(u(!0),y(ke,null,we(e.labels,l=>(u(),x(F,{class:r(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:i[0]||(i[0]=Se(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:Y(()=>[Me(B(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(u(),y("div",{key:1,class:r(e.n("values"))},B(e.labels.join(e.separator)),3))])):(u(),y("span",We,B(e.label),1)),W(b,{class:r(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])],6),v("label",{class:r(e.classes(e.n("placeholder"),"var--ellipsis",[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:C({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},B(e.placeholder),7)],2)]),_:3},8,["class","offset-y","show","onClose"]),v("div",{class:r(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[U(e.$slots,"append-icon",{},()=>[e.clearable?(u(),x(b,{key:0,class:r(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):ee("v-if",!0)])],2)],6),e.line?(u(),y("div",{key:0,class:r(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:C({background:e.errorMessage?void 0:e.blurColor})},[v("div",{class:r(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:C({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):ee("v-if",!0),W(T,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var P=Fe($e,[["render",Ye]]);P.install=function(e){e.component(P.name,P)};export{P as S};
