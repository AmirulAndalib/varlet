import{I as U}from"./index.e3d3045d.js";import{g as F,b as H,f as Y}from"./elements.fe3d8f92.js";import{d as I,c as j,f as R}from"./components.e153d5f1.js";import{d as q,a as l,b as f,w as Q,o as Z,Z as b,_ as $,p as G,f as g,h as B,M as J,q as K,N as w,R as W,O as X,az as x,i as V,S as k,ap as P,ai as ee,P as ae,Q as oe,F as se}from"./vue-router.esm-bundler.0e2db2be.js";import{C as te}from"./index.64085d6b.js";import{d as ne}from"./index.e436054e.js";import"./shared.1ad63abb.js";const le={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},target:{type:[String,Object]},onRefresh:I(),"onUpdate:modelValue":I()},{n:_,classes:re}=j("pull-refresh"),D=150,ue=q({name:"VarPullRefresh",components:{VarIcon:U},props:le,setup(e){let o,c;const n=l(0),u=l(null),i=l(null),d=l(0),a=l(-999),r=l("arrow-down"),s=l("default"),v=l(!1),p=l(!0),T=f(()=>s.value!=="loading"&&s.value!=="success"&&!e.disabled),E=f(()=>({transform:`translate3d(0px, ${a.value}px, 0px) translate(-50%, 0)`,transition:v.value?`transform ${e.animationDuration}ms`:void 0,background:y.value?e.successBgColor:e.bgColor,color:y.value?e.successColor:e.color})),m=f(()=>Math.abs(2*n.value)),y=f(()=>s.value==="success"),L=()=>new Promise(t=>{window.setTimeout(()=>{p.value=!0,t()},D)}),S=t=>{("classList"in o?o:document.body).classList[t](`${_()}--lock`)},M=t=>{const N=Y(o);if(N>0||!T.value)return;s.value!=="pulling"&&(s.value="pulling",d.value=t.touches[0].clientY),N===0&&a.value>n.value&&S("add");const C=(t.touches[0].clientY-d.value)/2+n.value;a.value=C>=m.value?m.value:C,a.value>=m.value*.2?(p.value=!1,r.value="refresh",c=L()):r.value="arrow-down"},O=async()=>{!T.value||(v.value=!0,a.value>=m.value*.2?(await c,s.value="loading",a.value=m.value*.3,R(e["onUpdate:modelValue"],!0),R(e.onRefresh),S("remove")):(s.value="loosing",r.value="arrow-down",a.value=n.value,setTimeout(()=>{v.value=!1,S("remove")},b(e.animationDuration))))},A=()=>{const{width:t}=i.value.getBoundingClientRect();a.value=-(t+t*.25),n.value=-(t+t*.25)},z=()=>{setTimeout(()=>{s.value="default",r.value="arrow-down",v.value=!1},b(e.animationDuration))};return Q(()=>e.modelValue,t=>{t===!1&&(v.value=!0,s.value="success",r.value="checkbox-marked-circle",setTimeout(()=>{a.value=n.value,z()},b(e.successDuration)))}),Z(()=>{o=e.target?F(e.target,"PullRefresh"):H(u.value),A()}),{n:_,classes:re,iconHasChanged:p,ICON_TRANSITION:D,refreshStatus:s,freshNode:u,controlNode:i,touchMove:M,touchEnd:O,iconName:r,controlStyle:E,isSuccess:y}}});function ce(e,o,c,n,u,i){const d=G("var-icon");return g(),B("div",{ref:"freshNode",class:w(e.n()),onTouchmove:o[0]||(o[0]=(...a)=>e.touchMove&&e.touchMove(...a)),onTouchend:o[1]||(o[1]=(...a)=>e.touchEnd&&e.touchEnd(...a)),onTouchcancel:o[2]||(o[2]=(...a)=>e.touchEnd&&e.touchEnd(...a))},[J("div",{ref:"controlNode",class:w(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:W(e.controlStyle)},[K(d,{name:e.iconName,transition:e.ICON_TRANSITION,class:w(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),X(e.$slots,"default")],34)}const h=$(ue,[["render",ce]]);h.install=function(e){e.component(h.name,h)};const ie={setup(e){const o=Array(30).fill("List Item"),c=Array(30).fill("This is new List Item"),n=l(!1),u=l(o),i=()=>{setTimeout(()=>{u.value=u.value[0]==="List Item"?c:o,n.value=!1},2e3)};return x(ne),(d,a)=>(g(),V(P(h),{onRefresh:i,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value=r),"success-duration":"2000"},{default:k(()=>[(g(!0),B(se,null,ee(u.value,(r,s)=>(g(),V(P(te),{key:s,border:""},{default:k(()=>[ae(oe(r+" "+(s+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},ye=$(ie,[["__scopeId","data-v-6ab151d9"]]);export{ye as default};
