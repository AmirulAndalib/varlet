import{I as F}from"./index.d4c11fb0.js";import{g as U,e as z}from"./elements.e0af8b84.js";import{d as H,a as l,b as f,w as Y,o as B,Z as N,_ as k,p as q,f as h,h as E,M as Q,q as Z,N as w,R as j,O as G,e as J,ay as K,i as b,S as I,al as D,ai as W,P as X,Q as x,F as ee}from"./vue-router.esm-bundler.5eeb4635.js";import{c as oe,f as V}from"./components.011f3236.js";import{C as ae}from"./index.04f2a985.js";import{d as te}from"./index.e9517f07.js";import"./shared.f77a40d1.js";const se={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},onRefresh:{type:Function},"onUpdate:modelValue":{type:Function}},{n:ne,classes:le}=oe("pull-refresh"),R=150,ue=H({name:"VarPullRefresh",components:{VarIcon:F},props:se,setup(e){let a,d;const n=l(0),c=l(null),v=l(null),i=l(0),o=l(-999),u=l("arrow-down"),s=l("default"),r=l(!1),g=l(!0),y=f(()=>s.value!=="loading"&&s.value!=="success"&&!e.disabled),P=f(()=>({transform:`translate3d(0px, ${o.value}px, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:S.value?e.successBgColor:e.bgColor,color:S.value?e.successColor:e.color})),m=f(()=>Math.abs(2*n.value)),S=f(()=>s.value==="success"),$=()=>new Promise(t=>{window.setTimeout(()=>{g.value=!0,t()},R)}),M=t=>{!y.value||(s.value="pulling",i.value=t.touches[0].clientY)},_=t=>{const T=z(a);if(T>0||!y.value)return;T===0&&o.value>n.value&&t.cancelable&&t.preventDefault();const C=(t.touches[0].clientY-i.value)/2+n.value;o.value=C>=m.value?m.value:C,o.value>=m.value*.2?(g.value=!1,u.value="refresh",d=$()):u.value="arrow-down"},L=async()=>{!y.value||(r.value=!0,o.value>=m.value*.2?(await d,s.value="loading",o.value=m.value*.3,V(e["onUpdate:modelValue"],!0),V(e.onRefresh)):(s.value="loosing",u.value="arrow-down",o.value=n.value,setTimeout(()=>{r.value=!1},N(e.animationDuration))))},O=()=>{const{width:t}=v.value.getBoundingClientRect();o.value=-(t+t*.25),n.value=-(t+t*.25)},A=()=>{setTimeout(()=>{s.value="default",u.value="arrow-down",r.value=!1},N(e.animationDuration))};return Y(()=>e.modelValue,t=>{t===!1&&(r.value=!0,s.value="success",u.value="checkbox-marked-circle",setTimeout(()=>{o.value=n.value,A()},N(e.successDuration)))}),B(()=>{a=U(c.value),O()}),{n:ne,classes:le,iconHasChanged:g,ICON_TRANSITION:R,refreshStatus:s,freshNode:c,controlNode:v,touchStart:M,touchMove:_,touchEnd:L,iconName:u,controlStyle:P,isSuccess:S}}});function re(e,a,d,n,c,v){const i=q("var-icon");return h(),E("div",{ref:"freshNode",class:w(e.n()),onTouchstart:a[0]||(a[0]=(...o)=>e.touchStart&&e.touchStart(...o)),onTouchmove:a[1]||(a[1]=(...o)=>e.touchMove&&e.touchMove(...o)),onTouchend:a[2]||(a[2]=(...o)=>e.touchEnd&&e.touchEnd(...o)),onTouchcancel:a[3]||(a[3]=(...o)=>e.touchEnd&&e.touchEnd(...o))},[Q("div",{ref:"controlNode",class:w(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:j(e.controlStyle)},[Z(i,{name:e.iconName,transition:e.ICON_TRANSITION,class:w(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),G(e.$slots,"default")],34)}const p=k(ue,[["render",re]]);p.install=function(e){e.component(p.name,p)};const ce={setup(e){const a=Array(10).fill("List Item"),d=Array(10).fill("This is new List Item"),n=l(!1),c=l(a),v=()=>{setTimeout(()=>{c.value=c.value[0]==="List Item"?d:a,n.value=!1},2e3)},i=o=>{o.preventDefault()};return B(()=>{document.body.addEventListener("touchmove",i,{passive:!1})}),J(()=>{document.body.removeEventListener("touchmove",i)}),K(te),(o,u)=>(h(),b(D(p),{onRefresh:v,modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=s=>n.value=s),"success-duration":"2000"},{default:I(()=>[(h(!0),E(ee,null,W(c.value,(s,r)=>(h(),b(D(ae),{key:r,border:""},{default:I(()=>[X(x(s+" "+(r+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},ge=k(ce,[["__scopeId","data-v-8f1c7769"]]);export{ge as default};
