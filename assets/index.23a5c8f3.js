import{S as W}from"./index.daa45547.js";import{d as M,r as c,b,T as Z,o as _,l as R,j as C,a as X,G as U,H as ee,Q as ne,m as I,t as f,y as oe,x as F,Y as te,c as k,F as H,k as Y,p as ae,n as z,e as w,i as D}from"./vendor.49f89f0d.js";import{c as se,d as re,b as le,f as ie}from"./components.721843ff.js";import{_ as O}from"./elevation.229458c1.js";import{t as L,h as ce,e as de}from"./shared.506a394a.js";import{h as V,c as ue,e as fe,d as ve,s as _e,n as me,r as he}from"./elements.e06eddab.js";import{C as pe}from"./index.ab4b9dcc.js";import{d as ye}from"./index.9b1139e6.js";import{u as xe,a as K,_ as be,b as Ce,c as ke}from"./en-US.628e0d34.js";import{w as ge,a as Ie}from"./utils.1735a57b.js";import"./index.12b80a72.js";const j=Symbol("INDEX_BAR_BIND_INDEX_ANCHOR_KEY"),q=Symbol("INDEX_BAR_COUNT_INDEX_ANCHOR_KEY");function Te(){const{bindChildren:e,childProviders:r}=se(j),{length:t}=re(q);return{length:t,indexAnchors:r,bindIndexAnchors:e}}function Be(){const{parentProvider:e,bindParent:r}=le(j),{index:t}=ie(q);if(!e||!r)throw Error('[Varlet] IndexAnchor: You should use this component in "IndexBar"');return{index:t,indexBar:e,bindIndexBar:r}}const Ne={index:{type:[Number,String]}};const Ee=M({name:"VarIndexAnchor",components:{VarSticky:W},inheritAttrs:!1,props:Ne,setup(e){const{index:r,indexBar:t,bindIndexBar:s}=Be(),o=c(0),u=c(!1),a=b(()=>e.index),l=c(null),{active:m,sticky:i,cssMode:B,stickyOffsetTop:N,zIndex:y}=t;return s({index:r,name:a,ownTop:o,setOwnTop:()=>{!l.value||(o.value=l.value.$el?l.value.$el.offsetTop:l.value.offsetTop)},setDisabled:g=>{u.value=g}}),{name:a,anchorEl:l,active:m,sticky:i,zIndex:y,disabled:u,cssMode:B,stickyOffsetTop:N,Transition:Z}}});function Ae(e,r,t,s,o,u){return _(),R(ne(e.sticky?"var-sticky":e.Transition),{"offset-top":e.sticky?e.stickyOffsetTop:null,"z-index":e.sticky?e.zIndex:null,disabled:e.disabled&&!e.cssMode,"css-mode":e.cssMode,ref:"anchorEl"},{default:C(()=>[X("div",ee({class:"var-index-anchor"},e.$attrs),[U(e.$slots,"default",{},()=>[I(f(e.name),1)])],16)]),_:3},8,["offset-top","z-index","disabled","css-mode"])}var Se=O(Ee,[["render",Ae]]);const $e={sticky:{type:Boolean,default:!0},stickyOffsetTop:{type:Number,default:0},cssMode:{type:Boolean,default:!1},hideList:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:1},highlightColor:{type:String},duration:{type:[Number,String],default:0},onClick:{type:Function},onChange:{type:Function}};const we=M({name:"VarIndexBar",props:$e,setup(e){const{length:r,indexAnchors:t,bindIndexAnchors:s}=Te(),o=c(null),u=c(""),a=c(null),l=c(null),m=c([]),i=c(),B=b(()=>e.sticky),N=b(()=>e.cssMode),y=b(()=>e.stickyOffsetTop),E=b(()=>e.zIndex);s({active:i,sticky:B,cssMode:N,stickyOffsetTop:y,zIndex:E});const A=n=>{var h;const d=de(n)?n.name.value:n;d===i.value||d===void 0||(i.value=d,(h=e.onChange)==null||h.call(e,d))},g=()=>{const{scrollHeight:n}=o.value,d=fe(o.value),{offsetTop:h}=l.value;t.forEach((v,p)=>{const S=v.ownTop.value,x=d-S+y.value-h,$=p===t.length-1?n:t[p+1].ownTop.value-v.ownTop.value;x>=0&&x<$&&!u.value&&(p&&!e.cssMode&&t[p-1].setDisabled(!0),v.setDisabled(!1),A(v))})},P=async(n,d)=>{var x;const{offsetTop:h}=l.value;if(d&&((x=e.onClick)==null||x.call(e,n)),n===i.value)return;const v=t.find(({name:$})=>n===$.value);if(!v)return;const p=v.ownTop.value-y.value+h,S=ve(o.value);u.value=n,A(n),await _e(o.value,{left:S,top:p,animation:ce,duration:L(e.duration)}),me(()=>{u.value=""})},J=n=>{he(()=>P(n,!0))};return oe(()=>r.value,async()=>{await V(),t.forEach(({name:n,setOwnTop:d})=>{n.value&&m.value.push(n.value),d()})}),F(async()=>{var n;await V(),a.value=ue(l.value),o.value=a.value===window?a.value.document.body:a.value,(n=a.value)==null||n.addEventListener("scroll",g)}),te(()=>{var n;(n=a.value)==null||n.removeEventListener("scroll",g)}),{barEl:l,active:i,zIndex:E,anchorNameList:m,toNumber:L,scrollTo:J,anchorClick:P}}}),De={class:"var-index-bar",ref:"barEl"},ze=["onClick"];function Oe(e,r,t,s,o,u){return _(),k("div",De,[U(e.$slots,"default"),X("ul",{class:"var-index-bar__anchor-list",style:z({zIndex:e.toNumber(e.zIndex)+2,display:e.hideList?"none":"block"})},[(_(!0),k(H,null,Y(e.anchorNameList,a=>(_(),k("li",{key:a,class:ae(["var-index-bar__anchor-item",{"var-index-bar__anchor-item--active":e.active===a}]),style:z({color:e.active===a&&e.highlightColor?e.highlightColor:""}),onClick:l=>e.anchorClick(a)},f(a),15,ze))),128))],4)],512)}var T=O(we,[["render",Oe]]);T.install=function(e){e.component(T.name,T)};var Pe={title:"\u6807\u9898",text:"\u6587\u672C"},Le={title:"Title",text:"Text"};const{add:G,use:Ve,pack:Me,packs:en,merge:nn}=xe(),Re=e=>{ke(e),Ve(e)};K("zh-CN",be);K("en-US",Ce);G("zh-CN",Pe);G("en-US",Le);const Xe={name:"IndexBarExample",components:{VarIndexBar:T,VarIndexAnchor:Se,VarCell:pe},setup(){const e=c([]),r=c("#e7edf7"),t=c("#2e67ba");F(()=>{for(let o=0;o<26;o++)e.value.push(String.fromCharCode(65+o))});const s=o=>{console.log(o)};return ge(Re),Ie(ye,o=>{r.value=o==="darkThemes"?"rgb(41, 42, 45)":"#e7edf7",t.value=o==="darkThemes"?"#3980e8":"#2e67ba"}),{color:t,bgColor:r,list:e,pack:Me,change:s}}};function Ue(e,r,t,s,o,u){const a=w("var-index-anchor"),l=w("var-cell"),m=w("var-index-bar");return _(),R(m,{onChange:s.change,duration:"300","sticky-offset-top":54},{default:C(()=>[(_(!0),k(H,null,Y(s.list,i=>(_(),k("div",{key:i},[D(a,{index:i,class:"var-index-anchor__example",style:z({background:s.bgColor,color:s.color})},{default:C(()=>[I(f(s.pack.title)+" "+f(i),1)]),_:2},1032,["index","style"]),D(l,null,{default:C(()=>[I(f(i)+" "+f(s.pack.text),1)]),_:2},1024),D(l,null,{default:C(()=>[I(f(i)+" "+f(s.pack.text),1)]),_:2},1024)]))),128))]),_:1},8,["onChange"])}var on=O(Xe,[["render",Ue]]);export{on as default};
